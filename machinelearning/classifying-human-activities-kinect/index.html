<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Recognizing Human Activities with Kinect - Choosing a temporal model &#8211; Trailblazer</title>
<meta name="description" content="">
<meta name="keywords" content="machinelearning,, computervision,, kinect,, classification,, hmm,, memm,, crf,, hcrf">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Recognizing Human Activities with Kinect - Choosing a temporal model">
<meta property="og:description" content="The personal webpage and weblog of Avi Singh.">
<meta property="og:url" content="http://avisingh599.github.io/machinelearning/classifying-human-activities-kinect/">
<meta property="og:site_name" content="Trailblazer">





<link rel="canonical" href="http://avisingh599.github.io/machinelearning/classifying-human-activities-kinect/">
<link href="http://avisingh599.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Trailblazer Feed">
<link rel="author" href="http://plus.google.com/+avisingh599?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://avisingh599.github.io/assets/css/main.min.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://avisingh599.github.io/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://avisingh599.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://avisingh599.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://avisingh599.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://avisingh599.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://avisingh599.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://avisingh599.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://avisingh599.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://avisingh599.github.io/images/apple-touch-icon-144x144-precomposed.png">

</head>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63278661-1', 'auto');
  ga('send', 'pageview');

</script>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://avisingh599.github.io">Trailblazer</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				<li><a href="http://avisingh599.github.io/" >Home</a></li>
		        
				<li><a href="http://avisingh599.github.io/about/" >About</a></li>
		        
				<li><a href="http://avisingh599.github.io/assets/cv.pdf" >Resume</a></li>
		        
				<li><a href="http://avisingh599.github.io/research/" >Research</a></li>
		        
				<li><a href="http://avisingh599.github.io/projects/" >Projects</a></li>
		        
				<li><a href="http://avisingh599.github.io/acads/" >Academics</a></li>
		        
				<li><a href="http://avisingh599.github.io/achievements/" >Achievements</a></li>
		        
				<li><a href="http://avisingh599.github.io/posts/" >Posts</a></li>
		        
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    
	<img src="http://avisingh599.github.io/images/bio-photo.jpg" class="bio-photo" alt="Avi Singh bio photo"></a>

<h3>Avi Singh</h3>
<p>Undergraduate, interested in Computer Vision</p>

<a href="http://facebook.com/avisingh94" class="author-social" target="_blank"><i class="fa fa-facebook-square"></i> Facebook</a>
<a href="http://linkedin.com/pub/avi-singh/7b/444/681" class="author-social" target="_blank"><i class="fa fa-linkedin-square"></i> LinkedIn</a>

<a href="http://plus.google.com/+avisingh599" class="author-social" target="_blank"><i class="fa fa-google-plus-square"></i> Google+</a>



<a href="http://github.com/avisingh599" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>






  </div>
  <article>
    <div class="headline-wrap">
      
        <h1><a href="http://avisingh599.github.io/machinelearning/classifying-human-activities-kinect/" rel="bookmark" title="Recognizing Human Activities with Kinect - Choosing a temporal model">Recognizing Human Activities with Kinect - Choosing a temporal model</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p><em>Update: I have posted the sequel to this post <a href="/machinelearning/classifying-human-activities-kinect-2/">here</a></em></p>

<p>In this blog post, I will very briefly talk about some popular models used for <strong>temporal/sequence classification</strong>, 
their advantages/disadvantages, which one I used for my human activity recognition project, and why. 
This post is intended for people who would like to delve into sequence classification, but don’t know where to start. 
I plan to follow up on this post with another post that explains in detail our implementation of recognizing human 
activities from RGBD data.  However, if you want to have a look at it now, 
<a href="/assets/activity-classification.pdf">here</a> are the slides.</p>

<p>In one my graduate-level course <strong>Machine Learning for Computer Vision</strong>, we were asked to select
a research paper to review and present. We selected the paper 
<a href="http://www.cs.cornell.edu/~jysung/paper/unstructured_human_activity_learning.pdf">Unstructured Human Activity Detection from RGBD Images</a>.
Our reasons for this selection were several: it was fairly recent (2012), had a large number of citations (according to google scholar, at least), and it dealt with sequential data (RGBD videos). Temporal models, or sequence classification, was
something that was not covered in our course, and so we were eager to explore this area of Machine Learning. 
We read the paper, made a <a href="/assets/activity-poster.pdf">poster</a> out of it, and presented it to our peers, TAs and the professor. </p>

<p>The next part of the course was more interesting, and it involved us picking up a Machine Learning problem, and
we then had the option of either implementing an existing approach to the problem, or we could come with our
own approach to solve it. We could have implemented the paper that we reviewed, but it seemed to more interesting
to have a look at the models available for sequence classification, and then use one 
such model for our problem. </p>

<p>So we started looking around, and found that that following three models (and their variations)
seem to be the most popular:</p>

<ol>
  <li>Hidden Markov Models (HMMs)</li>
  <li>Maximum Entropy Markov Models (MEMMs)</li>
  <li>Conditional Random Fields (CRFs)</li>
</ol>

<p>Here’s the very basic intuition about temporal models: Suppose you are reading some text character by character. The first 
character that you observe is an “i”. Now, what do you think are the chances of you observing another “i”. Pretty slim, right?
This is because consecutive “i” are pretty rare while reading english text. Modeling such probabilistic relationships
in a mathematical form is precisely why we use temporal models, instead of just using some regular classifier (such as
logistic regression). There’s two more popular models for sequential classification (or structured prediction, as some people
like to call it), and they are: 1) <strong>Structural SVM</strong>, 2) <strong>Recurrent Neural Nets</strong>. I won’t talk about for either of them,
as I have not used them, but you are welcome to check them out.</p>

<p>Hidden Markov Models are the oldest, and have been used in things like speech-to-text since the 1960s. MEMMs came
around in 2000, only to be followed (and overshadowed) by Conditional Random Fields an year later. Both MEMMs and CRF
came from the <a href="http://people.cs.umass.edu/~mccallum/">Andrew McCallum’s research group</a>, and were focused on <a href="http://en.wikipedia.org/wiki/Natural_language_processing">Natural Language Processing</a> tasks.
However, once you have extracted features from sequential data, you can use these models as long as your features
satisfy the assumptions made by these models. Note that all of these models are special cases of 
<a href="http://en.wikipedia.org/wiki/Graphical_model">probabilistic graphical models</a>, so all the inference and learning algorithms from 
there can directly be applied here. </p>

<h3 id="hidden-markov-models">Hidden Markov Models</h3>

<figure>
	<img img="" height="155" width="410" src="/images/kinect_activity/hmm.png" />
	<figcaption>Graphical Model Representation of a stack of HMMs</figcaption>
</figure>

<p>As I mentioned earlier, Hidden Markov Models have been around for a long time, and were heavily used by the speech processing community.
I won’t much into the details/code of HMMs, as there are a large number of resources that describe the topic, targeted both at 
<a href="http://www.comp.leeds.ac.uk/roger/HiddenMarkovModels/html_dev/main.html">beginners</a> and those who want to go into all the 
<a href="http://www.ece.ucsb.edu/Faculty/Rabiner/ece259/Reprints/tutorial%20on%20hmm%20and%20applications.pdf">details</a>. 
HMMs are <a href="http://en.wikipedia.org/wiki/Generative_model"><strong>generative models</strong></a>, and efficient dynamic programming algorithms 
are available for both training and inference. The models uses <strong>hidden states</strong>, and assumes that the <strong>observed states</strong> are independent of each other, given their hidden states. A common way to go about doing classification with HMMS is the following: Train an HMM
for every class, and then for every new example, find the probability of that example being generated by each HMM, the HMM that gives the
maximum probability is your final class. </p>

<p>However, with HMMs come a number of disadvantages, with the major ones being:</p>

<ol>
  <li>Requires enumeration of all possible observation sequences.</li>
  <li>Requires the observations to be independent of each other (given the hidden state).</li>
  <li>Generative approach for solving a conditional problem leading to unnecessary computations.</li>
</ol>

<h3 id="maximum-entropy-markov-models">Maximum Entropy Markov Models</h3>

<p>So, let’s move onto a new model, which, in theory, solves all of the above problems: MEMMs.
MEMMs were introduced in 2000, and were at that time used in NLP tasks, and showed
improvements in tasks where assumption [2] mentioned above was not true. MEMMs are discriminative models, so
they also do away with problems [1] and [3]. There’s also a hierarchical version of the same model, 
and a Hierarchical MEMM is what was used in the <a href="http://www.cs.cornell.edu/~jysung/paper/unstructured_human_activity_learning.pdf">paper</a> 
that we reviewed. The paper contains an interesting way of selecting graph structure, and I recommend checking it out.</p>

<figure>
	<img src="/images/kinect_activity/memm.png" />
	<figcaption>Graphical Representation of an MEMM. Note how the direction of arrow from observation to hidden state has been reversed.
	</figcaption>
</figure>

<p>But along with MEMMs comes it’s own problem, commonly called as the label-bias problem.</p>

<h4 id="label-bias-problem">Label bias problem</h4>

<ol>
  <li>States with low-entropy transition distributions ”effectively ignore” their observations. States with lower transitions have ”unfair advantage”.</li>
  <li>Since training is always done with respect to known previous tags, so the model struggles at test time when there is uncertainty in the previous tag.</li>
</ol>

<p>It is impossible to understand the above without some background on what MEMMs are, so it is advisable
to first look at <a href="http://courses.ischool.berkeley.edu/i290-dm/s11/SECURE/gidofalvi.pdf">how MEMMs work</a>
, and then at the original <a href="http://www.cs.columbia.edu/~jebara/6772/papers/crf.pdf">CRF paper</a>
which talks about the label bias problem.</p>

<h3 id="conditional-random-fields---star-of-the-show">Conditional Random Fields -&gt; Star of the show</h3>

<figure>
	<img img="" height="155" width="410" src="/images/kinect_activity/crf.png" />
	<figcaption>Graphical Representation of a CRF. Note that this an undirected graphical model, as opposed to HMM/MEMM</figcaption>
</figure>

<p>To overcome the label-bias problem of MEMMs, CRFs were introduced an year later, and demonstrated superior or
equivalent performance in almost every NLP task that the authors tested it on. CRFs (and its variants) are considered as 
state-of-the-art in a  number of machine learning problems, specially in Computer Vision. They are used not only 
for temporal modeling, but can also model more complicated relationships in high-dimensional data, and some applications include
image segmentation and depth estimation from monocular images. Understanding CRFs is a little more challenging than
HMMs or MEMMs, so I will list a few resources for you to get started with. For beginners, the best resource is this 
<a href="http://videolectures.net/cikm08_elkan_llmacrf/">short course</a> by <a href="http://cseweb.ucsd.edu/~elkan/">Charles Elkan</a>.
It also has accompanying course notes,
and if you go to this guy’s academic website, you can also find some programming assignments to implement CRFs. 
<a href="https://onionesquereality.wordpress.com/2011/08/20/conditional-random-fields-a-beginners-survey/">Here</a> is a 
more comprehensive list of resources related to CRFs, and it’s pretty thorough.</p>

<p>Now, in 2006, there was an extension to CRF by the MIT CSAIL lab, called hidden CRFs. Here is the original paper<a href="http://people.csail.mit.edu/sybor/cvpr06_wang.pdf">original paper</a>. What this does, in essence, is to introduce another layer of hidden states, and is designed to
assign a single label to every sequence. This is different from MEMMs and CRFs, which assigned a label to every observation in
a sequence, and different from HMMs too (wherein a stack of HMMs was trained for classification).</p>

<figure>
	<img img="" height="155" width="410" src="/images/kinect_activity/hcrf.png" />
	<figcaption>Graphical Representation of an hCRF. Note the extra hidden layer.</figcaption>
</figure>

<p>The original hCRF paper applied it to gesture recognition from RGB videos, and demonstrated superior
performance to CRF in classifying gestures, so we zeroed down on this model, to be used for our
Human Activity Classification task (note that activities are not exactly the same as gestures).</p>

<p>The real icing on the cake was this-&gt; MIT CSAIL had released a well documented <a href="http://sourceforge.net/projects/hcrf/">toolbox</a>,
making it ridiculously easy for us to use this model on whichever dataset that we wanted, and 
the only major programming part that was left to us now was was the feature extraction stage.</p>

<p>In a future blog post, I will describe in detail the implementation of our project: the dataset, the features we used,
and what results we got.</p>

      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          
	<img src="http://avisingh599.github.io/images/bio-photo.jpg" class="bio-photo" alt="Avi Singh bio photo"></a>

<h3>Avi Singh</h3>
<p>Undergraduate, interested in Computer Vision</p>

<a href="http://facebook.com/avisingh94" class="author-social" target="_blank"><i class="fa fa-facebook-square"></i> Facebook</a>
<a href="http://linkedin.com/pub/avi-singh/7b/444/681" class="author-social" target="_blank"><i class="fa fa-linkedin-square"></i> LinkedIn</a>

<a href="http://plus.google.com/+avisingh599" class="author-social" target="_blank"><i class="fa fa-google-plus-square"></i> Google+</a>



<a href="http://github.com/avisingh599" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>






        </div>
        <p class="byline"><strong>Recognizing Human Activities with Kinect - Choosing a temporal model</strong> was published on <time datetime="2015-05-27T00:00:00+00:00">May 27, 2015</time> and last modified on <time datetime="2015-06-02">June 02, 2015</time> by <a href="http://avisingh599.github.io/about" title="About Avi Singh">Avi Singh</a>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://avisingh599.github.io/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="http://avisingh599.github.io/machinelearning/classifying-human-activities-kinect-2/" title="Recognizing Human Activities with Kinect - The implementation">Recognizing Human Activities with Kinect - The implementation</a></li>
    
      <li><a href="http://avisingh599.github.io/vision/visual-odometry-full/" title="Visual Odmetry from scratch - A tutorial for beginners">Visual Odmetry from scratch - A tutorial for beginners</a></li>
    
      <li><a href="http://avisingh599.github.io/vision/stichting-story/" title="Stitching Intra-Oral Images">Stitching Intra-Oral Images</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2015 Avi Singh. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://avisingh599.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://avisingh599.github.io/assets/js/scripts.min.js"></script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'avisingh599'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

	        

</body>
</html>